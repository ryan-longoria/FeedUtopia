const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/roles-CaKbrTUl.js","assets/roles-Bsovybpk.css"])))=>i.map(i=>d[i]);
import{g as q,i as T,a as M}from"./roles-CaKbrTUl.js";import{a as y,b as P}from"./api-cu99Gag1.js";import{_ as N}from"./preload-helper-D7HrI6pR.js";window.WU_API="https://go2gft4394.execute-api.us-east-2.amazonaws.com";window.WU_MEDIA_BASE="https://d178p8k1vmj1zs.cloudfront.net";function h(n){const s=new FormData(n),t={};for(const[r,e]of s.entries())t[r]?Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]:t[r]=e;return t}function p(n,s="success"){const t=document.querySelector("#toast");if(!t){s==="error"?console.error(n):console.log(n);return}t.textContent=n,t.classList.toggle("error",s==="error"),t.style.display="block",setTimeout(()=>t.style.display="none",2600)}window.toast=p;function A(n){const s=document.querySelector("#talent-list");if(!s)return;const t=Array.isArray(n)?n:n?[n]:[];s.innerHTML="";const r=e=>`https://picsum.photos/seed/${encodeURIComponent(e)}/200/200`;t.forEach((e,a)=>{var b;const o=e.ring||e.ringName||e.stageName||e.name||"Wrestler",c=e.name||"",i=e.years??e.yearsExperience??0,l=Array.isArray(e.styles)?e.styles:Array.isArray(e.gimmicks)?e.gimmicks:[],d=[e.city,e.region,e.country].filter(Boolean).join(", "),u=e.rate_min??e.rateMin??0,m=e.rate_max??e.rateMax??0,v=!!e.verified_school||!!e.verifiedSchool,g=e.reel||e.reelLink||"#",w=(e.photoKey&&window.WU_MEDIA_BASE?`${window.WU_MEDIA_BASE}/${e.photoKey}`:e.avatar)||r(o),f=document.createElement("div");f.className="card",f.innerHTML=`<div class="profile">
      <img src="${w}" alt="${o} profile"/>
      <div class="info">
        <div><strong>${o}</strong> <span class="muted">(${c})</span></div>
        <div class="mt-2">${d||"—"} • ${i} yrs • ${l.join(", ")}</div>
        <div class="mt-2">${v?'<span class="badge">Verified school</span>':""}</div>
        <div class="mt-2 muted">Rate: $${u}-${m}</div>
        <div class="mt-3" style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn small view-profile-btn" type="button">View Profile</button>
          ${e.handle?`<a class="btn small secondary" href="/w/#${encodeURIComponent(e.handle)}">See Full Profile</a>`:""}
        </div>
      </div>
    </div>`,(b=f.querySelector(".view-profile-btn"))==null||b.addEventListener("click",()=>{var S;const x=`
        <div style="display:grid;grid-template-columns:120px 1fr;gap:16px">
          <img src="${w}" alt="Avatar" style="width:120px;height:120px;border-radius:999px;object-fit:cover;background:#0f1224;border:1px solid #1f2546"/>
          <div>
            <h2 style="margin:0">${o}</h2>
            <div class="muted">${d||""}</div>
            <div class="chips mt-2">${l.map(k=>`<span class="chip">${k}</span>`).join("")}</div>
          </div>
        </div>
        <div class="mt-3">
          ${e.bio?`<p>${String(e.bio).replace(/\n/g,"<br/>")}</p>`:'<p class="muted">No bio yet.</p>'}
        </div>
        <dl class="mt-3">
          <dt class="muted">Name</dt><dd>${c}</dd>
          ${e.dob?`<dt class="muted mt-2">DOB</dt><dd>${e.dob}</dd>`:""}
          ${v?'<dt class="muted mt-2">School</dt><dd>Verified</dd>':""}
        </dl>
        ${g!=="#"?`<div class="mt-3"><a class="btn small secondary" href="${g}" target="_blank" rel="noopener">Watch Reel</a></div>`:""}
      `,$=document.getElementById("wm-content");$&&($.innerHTML=x),(S=document.getElementById("wrestler-modal"))==null||S.showModal()}),s.appendChild(f)})}function C(n){const s=document.querySelector("#tryout-list");if(!s)return;s.innerHTML="";const t=Array.isArray(n)?n:n?[n]:[];if(t.length===0){s.innerHTML='<p class="muted">No open tryouts yet.</p>';return}t.forEach(r=>{const e=r.tryoutId||r.id,a=r.orgName||r.org||"",o=r.ownerId||"",c=r.city||"",i=r.date?new Date(r.date).toLocaleDateString():"",l=r.requirements||"",d=r.slots??0,u=(r.status||"open").toUpperCase(),m=document.createElement("div");m.className="card",m.dataset.tryoutId=e,m.innerHTML=`<div class="badge">${u}</div>
      <h3 style="margin:6px 0 2px">
        ${o?`<a href="/p/#${encodeURIComponent(o)}">${a}</a>`:a}
      </h3>
      <div class="muted">${c} • ${i}</div>
      <p class="mt-3">${l}</p>
      <div class="mt-3">
        <button class="btn small apply-btn" data-id="${e}" data-org="${a}">Apply</button>
        <span class="muted" style="margin-left:10px">Slots: ${d}</span>
      </div>`,s.appendChild(m)}),q().then(r=>{const e=M(r);document.querySelectorAll(".apply-btn").forEach(a=>{e?a.addEventListener("click",o=>{const c=o.currentTarget;window.openApply(c.dataset.id,c.dataset.org)}):(a.textContent="Log in as Wrestler to apply",a.addEventListener("click",o=>{var c;o.preventDefault(),(c=document.querySelector("#login-btn"))==null||c.click()},{once:!0}))})})}function E(n){const s=document.querySelector("#app-list");s&&(s.innerHTML="",(n||[]).forEach(t=>{const r=t.reelLink||t.reel||"#",e=t.timestamp||t.created_at||t.createdAt||new Date().toISOString(),a=t.notes||"",o=t.applicantId?`Applicant: ${t.applicantId}`:"",c=document.createElement("div");c.className="card",c.innerHTML=`<div><strong>${o}</strong></div>
      <div class="mt-2"><a href="${r}" target="_blank" rel="noopener">Reel</a> • <span class="muted">${new Date(e).toLocaleString()}</span></div>
      <div class="mt-2">${a}</div>`,s.appendChild(c)}))}function D(n,s){const t=document.querySelector("#apply-form");if(!t)return;t.tryout_id.value=n;const r=document.querySelector("#apply-title");r&&(r.textContent="Apply to "+s);const e=document.querySelector("#apply-modal");e&&e.showModal()}window.openApply=D;async function H(){var e;const n=document.querySelector("#talent-search"),s=((e=document.querySelector("#talent-list"))==null?void 0:e.closest("section, .card, .panel"))||document.querySelector("#talent-list");if(!n)return;const t=await q();if(!T(t)){s?s.innerHTML=`
        <div class="card">
          <h2>Talent Search <span class="badge">Locked</span></h2>
          <p class="muted">Only promoters can search wrestler profiles. 
          <a href="#" data-auth="out" id="become-promoter">Create a free promoter account</a>.</p>
        </div>`:(n.closest("section, .card, .panel")||n).style.display="none";return}const r=async()=>{try{const a=h(n),o=new URLSearchParams;a.style&&a.style!=="any"&&o.set("style",a.style),a.city&&o.set("city",a.city),a.verified==="true"&&o.set("verified","true"),a.q&&o.set("q",a.q);const c=`/profiles/wrestlers${o.toString()?"?"+o.toString():""}`,i=await y(c);A(i)}catch(a){console.error(a),p("You must be a promoter to view talent profiles.","error"),A([])}};["input","change"].forEach(a=>n.addEventListener(a,r)),r()}async function L(){const n=document.querySelector("#tryout-list");if(n)try{const s=await y("/tryouts"),t=P(s);if(C(t),location.hash){const r=location.hash.substring(1),e=document.querySelector(`[data-tryout-id="${r}"]`);e&&e.scrollIntoView({behavior:"smooth"})}}catch(s){if(String(s).includes("API 401")){n.innerHTML='<p class="muted">Please sign in to view tryouts.</p>';return}console.error(s),n.innerHTML='<p class="muted">Could not load tryouts.</p>'}}async function _(){if(document.querySelector("#app-list"))try{const t=new URL(location.href).searchParams.get("tryout"),r=t?`/applications?tryoutId=${encodeURIComponent(t)}`:"/applications",e=await y(r);E(e)}catch(s){console.error(s),E([])}}async function I(){const n=document.querySelector("#talent-form");n&&n.addEventListener("submit",async r=>{r.preventDefault();try{const e=h(n),a=(Array.isArray(e.styles)?e.styles:[e.styles]).filter(Boolean),o={name:e.name,ring:e.ring,city:e.city,travel:Number(e.travel||0),height_cm:Number(e.height_cm||0),weight_kg:Number(e.weight_kg||0),years:Number(e.years||0),school:e.school||"",styles:a,reel:e.reel||"",rate_min:Number(e.rate_min||0),rate_max:Number(e.rate_max||0),verified_school:!1};await y("/profiles/wrestlers",{method:"POST",body:o}),p("Talent profile saved!"),n.reset()}catch(e){console.error(e),p("Could not save profile","error")}});const s=document.querySelector("#tryout-form");s&&s.addEventListener("submit",async r=>{r.preventDefault();try{const e=h(s),a={orgName:e.org||"",city:e.city||"",date:e.date||"",slots:Number(e.slots||0),requirements:e.requirements||"",contact:e.contact||"",status:"open"};await y("/tryouts",{method:"POST",body:a}),p("Tryout posted!"),s.reset(),await L()}catch(e){console.error(e),p("Could not post tryout","error")}});const t=document.querySelector("#apply-form");t&&t.addEventListener("submit",async r=>{r.preventDefault();try{const e=h(t),a={tryoutId:e.tryout_id,notes:e.notes||"",reelLink:e.reel||""};await y("/applications",{method:"POST",body:a}),p("Application sent!"),t.reset();const o=document.querySelector("#apply-modal");o&&o.close(),await _()}catch(e){console.error(e),p("Could not submit application","error")}}),await Promise.all([H(),L(),_()])}document.addEventListener("DOMContentLoaded",I);window.addEventListener("auth:changed",I);(async function(){async function n(o){const c=await fetch(o,{cache:"no-cache"});if(!c.ok)throw new Error(`Failed to fetch ${o}: ${c.status}`);return await c.text()}function s(o){o.querySelectorAll("script").forEach(i=>{const l=document.createElement("script");for(const{name:d,value:u}of i.attributes)l.setAttribute(d,u);l.text=i.text,i.parentNode.replaceChild(l,i)})}async function t(o=document){let c=0;for(;;){const i=o.querySelectorAll("[data-include]");if(i.length===0)break;if(c++,await Promise.all(Array.from(i).map(async l=>{const d=l.getAttribute("data-include");try{const u=await n(d),m=document.createElement("div");m.innerHTML=u,l.replaceWith(...Array.from(m.childNodes)),s(document)}catch(u){console.error("Include failed for",d,u)}})),c>10){console.warn("include.js: stopping after 10 recursive passes to avoid loops");break}}}await t();try{const{applyRoleGatedUI:o}=await N(async()=>{const{applyRoleGatedUI:c}=await import("./roles-CaKbrTUl.js").then(i=>i.r);return{applyRoleGatedUI:c}},__vite__mapDeps([0,1]));await o()}catch(o){console.error("roles.js load/apply failed",o)}(function(){const c=location.pathname.split("/").pop()||"index.html";document.querySelectorAll(".wu-links a").forEach(i=>{(i.getAttribute("href")||"").split("#")[0]===c&&i.classList.add("active")})})();const r=document.getElementById("nav-toggle"),e=document.getElementById("nav-links");r&&e&&r.addEventListener("click",()=>{const o=e.classList.toggle("open");r.setAttribute("aria-expanded",o?"true":"false")});const a=document.getElementById("year");a&&(a.textContent=new Date().getFullYear())})();
