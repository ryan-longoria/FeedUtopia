<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#0b0b12"/>
  <title>WrestleUtopia – Indie Wrestling Talent & Tryouts</title>
  <meta name="description" content="WrestleUtopia is a recruiting portal connecting indie wrestling talent with promotions and schools. Create a profile, find tryouts, and get booked."/>
  <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml"/>
  <link rel="manifest" href="manifest.webmanifest"/>
  <meta property="og:title" content="WrestleUtopia"/>
  <meta property="og:description" content="Profiles • Tryouts • Bookings for indie wrestling"/>
  <meta property="og:image" content="/assets/logo.svg"/>
  <link rel="stylesheet" href="styles/styles.css"/>

  <script>window.WU_API = "https://go2gft4394.execute-api.us-east-2.amazonaws.com";</script>
  <script type="module" src="/js/auth-bridge.js"></script>
  <script type="module" src="/js/api.js"></script>
  <script type="module" src="/js/forms.js"></script>
  <!-- main.js is homepage-only; omit to avoid extra work on this page -->
  <script defer src="/js/include.js"></script>
  <script type="module" src="/js/roles.js"></script>
</head>
<body>
  <div data-include="partials/nav.html"></div>

  <main class="section container">
    <section id="search" class="card mt-4">
      <h2>Search Talent</h2>
      <form id="talent-search" class="mt-2">
        <div class="form-row">
          <div>
            <label for="q">Search</label>
            <input class="input" id="q" name="q" placeholder="Name, ring name, style..." autocomplete="off" inputmode="search"/>
          </div>
          <div>
            <label for="style">Style</label>
            <select class="input" id="style" name="style">
              <option value="any">Any</option>
              <option>Technical</option>
              <option>High-flyer</option>
              <option>Power</option>
              <option>Brawler</option>
              <option>Striker</option>
              <option>Lucha</option>
              <option>Strong Style</option>
            </select>
          </div>
        </div>
        <div class="form-row mt-2">
          <div>
            <label for="city">City contains</label>
            <input class="input" id="city" name="city" placeholder="e.g., San Antonio" autocomplete="address-level2"/>
          </div>
          <div>
            <label for="verified">Verified School</label>
            <select class="input" id="verified" name="verified">
              <option value="any">Any</option>
              <option value="true">Only verified</option>
            </select>
          </div>
        </div>
      </form>
      <div id="talent-list" class="grid cols-2 mt-3"></div>
    </section>
  </main>

  <div data-include="partials/footer.html"></div>

  <!-- Hard lock: show a "Locked" card unless Promoter -->
  <script type="module">
    import { getAuthState, isPromoter } from '/js/roles.js';
    (async () => {
      const s = await getAuthState();
      if (!isPromoter(s)) {
        const sec = document.querySelector('#search');
        if (sec) {
          sec.innerHTML = `
            <h2>Talent Search <span class="badge">Locked</span></h2>
            <div class="mt-2">
              <p class="muted">Only promoters can search wrestler profiles.</p>
              <a href="#" class="btn small" data-auth="out" id="become-promoter">Create a free promoter account</a>
            </div>`;
        }
      }
    })();
  </script>

  <dialog id="wrestler-modal" class="card" style="max-width:720px">
    <div id="wm-content"></div>
    <div class="mt-3" style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn secondary" type="button" id="wm-close">Close</button>
    </div>
  </dialog>
  <script type="module">
    const dlg = document.getElementById('wrestler-modal');
    const closeBtn = document.getElementById('wm-close');
    closeBtn?.addEventListener('click', ()=> dlg.close());
  </script>
</body>
</html>
